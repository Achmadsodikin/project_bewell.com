{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Abdul\\\\Documents\\\\GitHub\\\\PWD-Pharma-2-JCWM01\\\\front_end\\\\src\\\\pages\\\\admin\\\\ConfirmReject.jsx\";\nimport React from \"react\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport { Col, Button, Form, FormGroup, Label, Input, FormText, Table } from 'reactstrap';\nimport Axios from \"axios\";\nimport { URL_API } from '../../helper';\nimport moment from \"moment\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass ConfirmReject extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      dbtransaction: []\n    };\n\n    this.getData = () => {\n      Axios.get(`${URL_API}/admin/confirm-reject`).then(res => {\n        this.setState({\n          dbtransaction: res.data.results\n        });\n      }).catch(err => {\n        alert(\"Cannot Get Transaction Data\");\n        console.log(err);\n      });\n    };\n\n    this.confirmBtnHandler = (transactionId, productId, qty, stock, bottle_volume) => {\n      const confirmation = window.confirm(\"Are you sure want to confirm transaction?\");\n\n      if (confirmation) {\n        this.transactionStatus(transactionId);\n        this.stockDecrease(productId, qty, stock, bottle_volume);\n      } else {\n        alert(\"Confirm Transaction Canceled\");\n      }\n    };\n\n    this.transactionStatus = transactionId => {\n      Axios.patch(`${URL_API}/admin/confirm/${transactionId}`, {\n        updateStatus: \"shipping\"\n      }).then(() => {\n        alert(\"Transaction Confirmed\");\n        this.getData();\n      }).catch(() => {\n        alert(\"Failed to Confirm Transaction\");\n      });\n    };\n\n    this.stockDecrease = (productId, qty, stock, bottle_volume) => {\n      Axios.patch(`${URL_API}/admin/stock-decrease/${productId}`, {\n        newStockQty: parseInt((stock / bottle_volume - qty) * bottle_volume)\n      }).then(() => {\n        alert(\"Product Stock Decreased\"); // this.getData()\n      }).catch(() => {\n        alert(\"Failed to Decrease Stock\");\n      });\n    };\n\n    this.rejectBtnHandler = transactionId => {\n      const confirm = window.confirm(\"Are you sure want to reject transaction?\");\n\n      if (confirm) {\n        Axios.patch(`${URL_API}/admin/reject/${transactionId}`, {\n          updateStatus: \"reject\"\n        }).then(() => {\n          alert(\"Transaction Rejected\");\n          this.getData();\n        }).catch(() => {\n          alert(\"Failed to Reject Transaction\");\n        });\n      } else {\n        alert(\"Reject Transaction Canceled\");\n      }\n    };\n\n    this.printData = () => {\n      return this.state.dbtransaction.map((item, index) => {\n        return /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: index + 1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: item.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: item.product_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: item.product_price\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: item.qty\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: [\"Rp \", item.total_price.toLocaleString(\"id\")]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: [\"Rp \", item.tax.toLocaleString(\"id\")]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: [\"Rp \", item.shipping_cost.toLocaleString(\"id\")]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: [\"Rp \", (item.total_price + item.tax + item.shipping_cost).toLocaleString(\"id\")]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: moment(item.date).format(\"D MMM YYYY, HH:mm:ss\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: URL_API + item.image,\n              alt: \"\",\n              style: {\n                height: \"125px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"align-middle\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-success mx-1\",\n              onClick: () => this.confirmBtnHandler(item.id_transaction, item.id_product, item.qty, item.stock, item.bottle_volume),\n              children: \"Confirm\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-danger mx-1\",\n              onClick: () => this.rejectBtnHandler(item.id_transaction),\n              children: \"Reject\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }, this);\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.getData();\n  }\n\n  render() {\n    if (this.props.userGlobal.role !== \"admin\") {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          marginTop: \"50px\",\n          marginBottom: \"20px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Confirm or Reject User's Transaction\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row m-auto\",\n        style: {\n          alignItems: \"center\",\n          justifyContent: \"center\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-18 mx-2 text-center\",\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            className: \"table-striped table-hover\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \"thead-dark\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"No.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 128,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Username\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Product\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Quantity\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Total Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 133,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Tax\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Shipping Cost\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Grand Total\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 136,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 137,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Image\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  children: \"Action\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 139,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: this.printData()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    userGlobal: state.user\n  };\n};\n\nexport default connect(mapStateToProps)(ConfirmReject);","map":{"version":3,"sources":["C:/Users/Abdul/Documents/GitHub/PWD-Pharma-2-JCWM01/front_end/src/pages/admin/ConfirmReject.jsx"],"names":["React","Link","Redirect","connect","Col","Button","Form","FormGroup","Label","Input","FormText","Table","Axios","URL_API","moment","ConfirmReject","Component","state","dbtransaction","getData","get","then","res","setState","data","results","catch","err","alert","console","log","confirmBtnHandler","transactionId","productId","qty","stock","bottle_volume","confirmation","window","confirm","transactionStatus","stockDecrease","patch","updateStatus","newStockQty","parseInt","rejectBtnHandler","printData","map","item","index","username","product_name","product_price","total_price","toLocaleString","tax","shipping_cost","date","format","image","height","id_transaction","id_product","componentDidMount","render","props","userGlobal","role","display","alignItems","justifyContent","marginTop","marginBottom","mapStateToProps","user"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport { connect } from 'react-redux';\r\nimport { Col, Button, Form, FormGroup, Label, Input, FormText, Table } from 'reactstrap';\r\nimport Axios from \"axios\";\r\nimport { URL_API } from '../../helper';\r\nimport moment from \"moment\";\r\n\r\nclass ConfirmReject extends React.Component {\r\n  state = {\r\n    dbtransaction: []\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getData()\r\n  }\r\n\r\n  getData = () => {\r\n    Axios.get(`${URL_API}/admin/confirm-reject`)\r\n    .then(res => {\r\n      this.setState({ dbtransaction: res.data.results })\r\n    })\r\n    .catch(err => {\r\n      alert(\"Cannot Get Transaction Data\")\r\n      console.log(err)\r\n    })\r\n  }\r\n\r\n  confirmBtnHandler = (transactionId, productId, qty, stock, bottle_volume) => {\r\n    const confirmation = window.confirm(\"Are you sure want to confirm transaction?\")\r\n    if (confirmation) {\r\n      this.transactionStatus(transactionId)\r\n      this.stockDecrease(productId, qty, stock, bottle_volume)\r\n    } else {\r\n      alert(\"Confirm Transaction Canceled\")\r\n    }\r\n  }\r\n\r\n  transactionStatus = (transactionId) => {\r\n    Axios.patch(`${URL_API}/admin/confirm/${transactionId}`, {\r\n      updateStatus: \"shipping\"\r\n    })\r\n    .then(() => {\r\n      alert(\"Transaction Confirmed\")\r\n      this.getData()\r\n    })\r\n    .catch(() => {\r\n      alert(\"Failed to Confirm Transaction\")\r\n    })\r\n  }\r\n\r\n  stockDecrease = (productId, qty, stock, bottle_volume) => {\r\n    Axios.patch(`${URL_API}/admin/stock-decrease/${productId}`, {\r\n      newStockQty: parseInt(((stock / bottle_volume) - qty) * bottle_volume)\r\n    })\r\n    .then(() => {\r\n      alert(\"Product Stock Decreased\")\r\n      // this.getData()\r\n    })\r\n    .catch(() => {\r\n      alert(\"Failed to Decrease Stock\")\r\n    })\r\n  }\r\n\r\n  rejectBtnHandler = (transactionId) => {\r\n    const confirm = window.confirm(\"Are you sure want to reject transaction?\")\r\n    if (confirm) {\r\n      Axios.patch(`${URL_API}/admin/reject/${transactionId}`, {\r\n        updateStatus: \"reject\"\r\n      })\r\n      .then(() => {\r\n        alert(\"Transaction Rejected\")\r\n        this.getData()\r\n      })\r\n      .catch(() => {\r\n        alert(\"Failed to Reject Transaction\")\r\n      })\r\n    } else {\r\n      alert(\"Reject Transaction Canceled\")\r\n    }\r\n  }\r\n\r\n  printData = () => {\r\n    return this.state.dbtransaction.map((item, index) => {\r\n      return (\r\n        <tr>\r\n          <td className=\"align-middle\">{index+1}</td>\r\n          <td className=\"align-middle\">{item.username}</td>\r\n          <td className=\"align-middle\">{item.product_name}</td>\r\n          <td className=\"align-middle\">{item.product_price}</td>\r\n          <td className=\"align-middle\">{item.qty}</td>\r\n          <td className=\"align-middle\">Rp {(item.total_price).toLocaleString(\"id\")}</td>\r\n          <td className=\"align-middle\">Rp {(item.tax).toLocaleString(\"id\")}</td>\r\n          <td className=\"align-middle\">Rp {(item.shipping_cost).toLocaleString(\"id\")}</td>\r\n          <td className=\"align-middle\">Rp {(item.total_price + item.tax + item.shipping_cost).toLocaleString(\"id\")}</td>\r\n          <td className=\"align-middle\">{moment(item.date).format(\"D MMM YYYY, HH:mm:ss\")}</td>\r\n          <td className=\"align-middle\">\r\n            <img src={URL_API + item.image} alt=\"\" style={{ height: \"125px\" }} />\r\n          </td>\r\n          <td className=\"align-middle\">\r\n            <button className=\"btn btn-success mx-1\" onClick={() => this.confirmBtnHandler(item.id_transaction, item.id_product, item.qty, item.stock, item.bottle_volume)}>\r\n              Confirm\r\n            </button>\r\n            <button className=\"btn btn-danger mx-1\" onClick={() => this.rejectBtnHandler(item.id_transaction)}>\r\n              Reject\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      )\r\n    })\r\n  }\r\n\r\n  render() {\r\n    if (this.props.userGlobal.role !== \"admin\") {\r\n      return <Redirect to=\"/\" />;\r\n    }\r\n  \r\n    return (\r\n      <>\r\n        <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\", marginTop: \"50px\", marginBottom: \"20px\" }}>\r\n          <h2>Confirm or Reject User's Transaction</h2>\r\n        </div>\r\n        <div className=\"row m-auto\" style={{ alignItems: \"center\", justifyContent: \"center\" }}>\r\n        <div className=\"col-md-18 mx-2 text-center\">\r\n          <Table className=\"table-striped table-hover\">\r\n            <thead className=\"thead-dark\">\r\n              <tr>\r\n                <th>No.</th>\r\n                <th>Username</th>\r\n                <th>Product</th>\r\n                <th>Price</th>\r\n                <th>Quantity</th>\r\n                <th>Total Price</th>\r\n                <th>Tax</th>\r\n                <th>Shipping Cost</th>\r\n                <th>Grand Total</th>\r\n                <th>Date</th>\r\n                <th>Image</th>\r\n                <th>Action</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.printData()}\r\n            </tbody>\r\n          </Table>\r\n        </div>\r\n      </div>\r\n    </>\r\n    )\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    userGlobal: state.user\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(ConfirmReject);"]},"metadata":{},"sourceType":"module"}